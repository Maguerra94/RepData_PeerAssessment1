---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
## Loading and preprocessing the data
```{r, echo = TRUE}
if( !file.exists("activity.csv")){
unzip("activity.zip")
}
unzip("activity.zip")
data<-read.csv("activity.csv", header=TRUE)
names(data)
head(data)
datana<- na.omit(data)
```
## What is mean total number of steps taken per day?

1. Calculate the total number of steps taken per day

```{r, echo = TRUE}
daily_steps<- aggregate( datana$steps, by= list(Steps.Date=datana$date), FUN="sum")
```

2. Histogram of the total number of steps taken each day
```{r, echo = TRUE}
hist(daily_steps$x, col="pink",
     breaks=20,
     main= "Total number of steps taken per day",
     xlab="Number of steps per day")
```

3. Mean and median number of steps taken each day
```{r, echo = TRUE}
mean_steps <- mean (daily_steps [,2])
print(mean_steps)

median_steps <-median (daily_steps [,2])
print(median_steps)
```

## What is the average daily activity pattern?
1. Time series plot of the average number of steps taken
```{r, echo = TRUE}
average<-aggregate(datana$steps, by= list(steps.interval=datana$interval), FUN="sum")
plot(average$steps.interval, average$x, type="l", xlab="Intervals", ylab="Average number of steps taken")

```
2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r, echo = TRUE}
interval_max_steps <- average[which.max(average$x),]$steps.interval
interval_max_steps
```

## Imputing missing values
1. Calculate and report the total number of missing values in the dataset
```{r, echo = TRUE}
totalNA<-sum(is.na(data$steps))
totalNA
```
2. Devise a strategy for filling in all of the missing values in the dataset. 
(use the mean/median for that day, or the mean for that 5-minute interval)
```{r, echo = TRUE}
meandata<-mean(datana$steps)
```
3. Create a new dataset that is equal to the original dataset but with the missing data filled in.

```{r, echo = TRUE}
data_in <- data
sum(is.na(data_in))
```

```{r, echo = TRUE}
data_in$steps[is.na(data_in$steps)] <- meandata
colSums(is.na(data_in))
```

Let's probe it works:
```{r, echo = TRUE}
sum(is.na(data_in))
```

## Are there differences in activity patterns between weekdays and weekends?
